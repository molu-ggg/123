



<!DOCTYPE html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="å¤åˆ¶">
      
        <meta name="lang:clipboard.copied" content="å·²å¤åˆ¶">
      
        <meta name="lang:search.language" content="jp">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„ç»“æœ">
      
        <meta name="lang:search.result.one" content="æ‰¾åˆ° 1 ä¸ªç¬¦åˆæ¡ä»¶çš„ç»“æœ">
      
        <meta name="lang:search.result.other" content="# ä¸ªç¬¦åˆæ¡ä»¶çš„ç»“æœ">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.0.6">
    
    
      
        <title>æ•°æ®åˆ†æç®—æ³• - MOLU</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.451f80e5.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#009688">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="teal" data-md-color-accent="pink">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#1" tabindex="1" class="md-skip">
        è·³è½¬è‡³
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="MOLU" class="md-header-nav__button md-logo">
          
            <i class="md-icon">î Œ</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                MOLU
              </span>
              <span class="md-header-nav__topic">
                æ•°æ®åˆ†æç®—æ³•
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="æœç´¢" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            é”®å…¥ä»¥å¼€å§‹æœç´¢
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href=".." title="ä¸»é¡µ" class="md-tabs__link">
        ä¸»é¡µ
      </a>
    
  </li>

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="./" title="æœºå™¨ä¸æ·±åº¦å­¦ä¹ " class="md-tabs__link md-tabs__link--active">
          æœºå™¨ä¸æ·±åº¦å­¦ä¹ 
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../new_error/" title="é—®é¢˜ä¸åˆ†æ" class="md-tabs__link">
          é—®é¢˜ä¸åˆ†æ
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../cè§†é¢‘ç»å…¸ç®—æ³•/" title="ç»å…¸ç®—æ³•" class="md-tabs__link">
          ç»å…¸ç®—æ³•
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../d_Deepwalk/" title="é«˜çº§ç®—æ³•" class="md-tabs__link">
          é«˜çº§ç®—æ³•
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="MOLU" class="md-nav__button md-logo">
      
        <i class="md-icon">î Œ</i>
      
    </a>
    MOLU
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="ä¸»é¡µ" class="md-nav__link">
      ä¸»é¡µ
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      æœºå™¨ä¸æ·±åº¦å­¦ä¹ 
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        æœºå™¨ä¸æ·±åº¦å­¦ä¹ 
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        æ•°æ®åˆ†æç®—æ³•
      </label>
    
    <a href="./" title="æ•°æ®åˆ†æç®—æ³•" class="md-nav__link md-nav__link--active">
      æ•°æ®åˆ†æç®—æ³•
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">ç›®å½•</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" title="1.æœ€çŸ­è·¯å¾„" class="md-nav__link">
    1.æœ€çŸ­è·¯å¾„
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" title="2.æ•°å€¼æ¦‚ç‡ç®—æ³•å’Œèˆä¼å¾·ç®—æ³•ã€‚" class="md-nav__link">
    2.æ•°å€¼æ¦‚ç‡ç®—æ³•å’Œèˆä¼å¾·ç®—æ³•ã€‚
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" title="3.ç°è‰²é¢„æµ‹" class="md-nav__link">
    3.ç°è‰²é¢„æµ‹
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" title="4.èšç±»ç®—æ³•" class="md-nav__link">
    4.èšç±»ç®—æ³•
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5" title="5.è’™ç‰¹å¡æ´›" class="md-nav__link">
    5.è’™ç‰¹å¡æ´›
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6" title="6.æ¨¡æ‹Ÿé€€ç«" class="md-nav__link">
    6.æ¨¡æ‹Ÿé€€ç«
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7" title="7.é—ä¼ ç®—æ³•" class="md-nav__link">
    7.é—ä¼ ç®—æ³•
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8" title="8.ç²’å­ç¾¤ç®—æ³•" class="md-nav__link">
    8.ç²’å­ç¾¤ç®—æ³•
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9" title="9.ç§ç¾¤ç«äº‰ï¼š" class="md-nav__link">
    9.ç§ç¾¤ç«äº‰ï¼š
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10" title="10.æ’é˜Ÿè®ºï¼š" class="md-nav__link">
    10.æ’é˜Ÿè®ºï¼š
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11" title="11.å±‚æ¬¡åˆ†æï¼š" class="md-nav__link">
    11.å±‚æ¬¡åˆ†æï¼š
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12" title="12.å¤šå…ƒå›å½’ï¼š" class="md-nav__link">
    12.å¤šå…ƒå›å½’ï¼š
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#13" title="13.ä¸»æˆåˆ†åˆ†æï¼š" class="md-nav__link">
    13.ä¸»æˆåˆ†åˆ†æï¼š
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#14" title="14.ç¥ç»ç½‘ç»œ" class="md-nav__link">
    14.ç¥ç»ç½‘ç»œ
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#221" title="ç¥ç»ç½‘ç»œï¼ˆ2,2,1ï¼‰ç»“æ„" class="md-nav__link">
    ç¥ç»ç½‘ç»œï¼ˆ2,2,1ï¼‰ç»“æ„
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../a_cnn/" title="CNN" class="md-nav__link">
      CNN
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../a_ç™¾åº¦æŠ€æœ¯è®¤è¯/" title="ç™¾åº¦æŠ€æœ¯è®¤è¯" class="md-nav__link">
      ç™¾åº¦æŠ€æœ¯è®¤è¯
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      é—®é¢˜ä¸åˆ†æ
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        é—®é¢˜ä¸åˆ†æ
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../new_error/" title="æ–¹å·®,åå·®ï¼Œå™ªå£°" class="md-nav__link">
      æ–¹å·®,åå·®ï¼Œå™ªå£°
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../new_modern/" title="æ¨¡å‹è¯„ä¼°æ–¹æ³•å’Œæ€§èƒ½æŒ‡æ ‡" class="md-nav__link">
      æ¨¡å‹è¯„ä¼°æ–¹æ³•å’Œæ€§èƒ½æŒ‡æ ‡
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../new_sigmoid/" title="æ¿€æ´»å‡½æ•°ä¸æ¢¯åº¦æ¶ˆå¤±ï¼Œæ¢¯åº¦çˆ†ç‚¸" class="md-nav__link">
      æ¿€æ´»å‡½æ•°ä¸æ¢¯åº¦æ¶ˆå¤±ï¼Œæ¢¯åº¦çˆ†ç‚¸
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../new_test/" title="éªŒè¯é›†ä¸æµ‹è¯•é›†" class="md-nav__link">
      éªŒè¯é›†ä¸æµ‹è¯•é›†
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../new_transfer/" title="æ¬ æ‹Ÿåˆï¼Œè¿‡æ‹Ÿåˆï¼Œæ­£åˆ™åŒ–" class="md-nav__link">
      æ¬ æ‹Ÿåˆï¼Œè¿‡æ‹Ÿåˆï¼Œæ­£åˆ™åŒ–
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      ç»å…¸ç®—æ³•
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        ç»å…¸ç®—æ³•
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../cè§†é¢‘ç»å…¸ç®—æ³•/" title="è“æ¡¥æ¯åŸºç¡€" class="md-nav__link">
      è“æ¡¥æ¯åŸºç¡€
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cè“æ¡¥æ¯ç»ƒä¹ é¢˜/" title="è“æ¡¥æ¯é¢˜" class="md-nav__link">
      è“æ¡¥æ¯é¢˜
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cèƒŒåŒ…é—®é¢˜/" title="èƒŒåŒ…é—®é¢˜" class="md-nav__link">
      èƒŒåŒ…é—®é¢˜
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../c_leetcode/" title="leetcode" class="md-nav__link">
      leetcode
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      é«˜çº§ç®—æ³•
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        é«˜çº§ç®—æ³•
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../d_Deepwalk/" title="Deepwalkç­‰" class="md-nav__link">
      Deepwalkç­‰
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../d_GAN/" title="GAN" class="md-nav__link">
      GAN
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../d_GCNè®ºæ–‡è§£è¯»/" title="GCN" class="md-nav__link">
      GCN
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../d_GAT/" title="GAT" class="md-nav__link">
      GAT
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">ç›®å½•</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" title="1.æœ€çŸ­è·¯å¾„" class="md-nav__link">
    1.æœ€çŸ­è·¯å¾„
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" title="2.æ•°å€¼æ¦‚ç‡ç®—æ³•å’Œèˆä¼å¾·ç®—æ³•ã€‚" class="md-nav__link">
    2.æ•°å€¼æ¦‚ç‡ç®—æ³•å’Œèˆä¼å¾·ç®—æ³•ã€‚
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" title="3.ç°è‰²é¢„æµ‹" class="md-nav__link">
    3.ç°è‰²é¢„æµ‹
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" title="4.èšç±»ç®—æ³•" class="md-nav__link">
    4.èšç±»ç®—æ³•
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5" title="5.è’™ç‰¹å¡æ´›" class="md-nav__link">
    5.è’™ç‰¹å¡æ´›
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6" title="6.æ¨¡æ‹Ÿé€€ç«" class="md-nav__link">
    6.æ¨¡æ‹Ÿé€€ç«
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7" title="7.é—ä¼ ç®—æ³•" class="md-nav__link">
    7.é—ä¼ ç®—æ³•
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8" title="8.ç²’å­ç¾¤ç®—æ³•" class="md-nav__link">
    8.ç²’å­ç¾¤ç®—æ³•
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9" title="9.ç§ç¾¤ç«äº‰ï¼š" class="md-nav__link">
    9.ç§ç¾¤ç«äº‰ï¼š
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10" title="10.æ’é˜Ÿè®ºï¼š" class="md-nav__link">
    10.æ’é˜Ÿè®ºï¼š
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11" title="11.å±‚æ¬¡åˆ†æï¼š" class="md-nav__link">
    11.å±‚æ¬¡åˆ†æï¼š
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12" title="12.å¤šå…ƒå›å½’ï¼š" class="md-nav__link">
    12.å¤šå…ƒå›å½’ï¼š
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#13" title="13.ä¸»æˆåˆ†åˆ†æï¼š" class="md-nav__link">
    13.ä¸»æˆåˆ†åˆ†æï¼š
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#14" title="14.ç¥ç»ç½‘ç»œ" class="md-nav__link">
    14.ç¥ç»ç½‘ç»œ
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#221" title="ç¥ç»ç½‘ç»œï¼ˆ2,2,1ï¼‰ç»“æ„" class="md-nav__link">
    ç¥ç»ç½‘ç»œï¼ˆ2,2,1ï¼‰ç»“æ„
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>æ•°æ®åˆ†æç®—æ³•</h1>
                
                <h2 id="1">1.æœ€çŸ­è·¯å¾„<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<p>æœ‰å‘å›¾åˆ°å„ç‚¹çš„æœ€çŸ­è·ç¦»ï¼š</p>
<p>ç±»ä¼¼ï¼šè¿™ç§å›¾æˆ–è€…é‚»æ¥çŸ©é˜µçš„å½¢å¼ï¼Œå¯ä»¥å¾—åˆ°æŸä¸€ç‚¹aå‘å„ä¸ªèŠ‚ç‚¹çš„æœ€çŸ­è·¯å¾„</p>
<p><img alt="img" src="https://gitee.com/moluggg/image/raw/master/img/202007/26/120821-168754.jpeg" /></p>
<p>ç®—æ³•æè¿°ï¼š</p>
<ol>
<li>
<p>åˆå§‹åŒ–ï¼Œä»¥è¯¥èŠ‚ç‚¹æ›´æ–°ä¸æœ‰å‘è¿æ¥çš„é‚»ç»“ç‚¹çš„è·ç¦»è¿›è¡Œæ›´æ–°ï¼Œä¸èƒ½é€šè¿‡çš„ï¼Œä¸¤è€…ä¹‹é—´è·ç¦»ä¸ºæ­£æ— ç©·ã€</p>
</li>
<li>
<p>æ‰¾å‡ºæœ€çŸ­è·¯çš„ç»“ç‚¹bï¼Œç¡®å®šè¯¥è·¯å¾„abæ˜¯aåˆ°bçš„æœ€çŸ­è·¯ï¼Œå¹¶å°†bä½œä¸ºä¸‹ä¸€èŠ‚ç‚¹ï¼Œç»§ç»­é‡å¤ç®—æ³•ä¸€ç›´åˆ°ç»“æŸã€‚</p>
</li>
<li>ä»¥è¯¥èŠ‚ç‚¹æ›´æ–°ä¸æœ‰å‘è¿æ¥çš„é‚»ç»“ç‚¹çš„è·ç¦»è¿›è¡Œæ›´æ–°ï¼Œ<span><span class="MathJax_Preview">dis[a][y]=min(dis[x][y],dis[x][b]+dis[b][y])</span><script type="math/tex">dis[a][y]=min(dis[x][y],dis[x][b]+dis[b][y])</script></span></li>
<li>é‡å¤23è¿‡ç¨‹ä¸€ç›´åˆ°ç»“æŸ</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="cpf">&lt;fstream&gt;</span><span class="cp"></span>
<span class="cp">#define MaxNum 765432100</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="n">ifstream</span> <span class="nf">fin</span><span class="p">(</span><span class="s">&quot;Dijkstra.in&quot;</span><span class="p">);</span>
<span class="n">ofstream</span> <span class="nf">fout</span><span class="p">(</span><span class="s">&quot;Dijkstra.out&quot;</span><span class="p">);</span>

<span class="kt">int</span> <span class="n">Map</span><span class="p">[</span><span class="mi">501</span><span class="p">][</span><span class="mi">501</span><span class="p">];</span>
<span class="kt">bool</span> <span class="n">is_arrived</span><span class="p">[</span><span class="mi">501</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">Dist</span><span class="p">[</span><span class="mi">501</span><span class="p">],</span><span class="n">From</span><span class="p">[</span><span class="mi">501</span><span class="p">],</span><span class="n">Stack</span><span class="p">[</span><span class="mi">501</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">Path</span><span class="p">,</span><span class="n">Source</span><span class="p">,</span><span class="n">Vertex</span><span class="p">,</span><span class="n">Temp</span><span class="p">,</span><span class="n">SetCard</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">FindMin</span><span class="p">()</span>
<span class="p">{</span>
<span class="kt">int</span> <span class="n">p</span><span class="p">,</span><span class="n">Temp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">Minm</span><span class="o">=</span><span class="n">MaxNum</span><span class="p">;</span>
<span class="k">for</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">p</span><span class="o">&lt;=</span><span class="n">Vertex</span><span class="p">;</span><span class="n">p</span><span class="o">++</span><span class="p">)</span>
<span class="k">if</span> <span class="p">((</span><span class="n">Dist</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">&lt;</span><span class="n">Minm</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="o">!</span><span class="n">is_arrived</span><span class="p">[</span><span class="n">p</span><span class="p">]))</span>
<span class="p">{</span>
<span class="n">Minm</span><span class="o">=</span><span class="n">Dist</span><span class="p">[</span><span class="n">p</span><span class="p">];</span>
<span class="n">Temp</span><span class="o">=</span><span class="n">p</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">return</span> <span class="n">Temp</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
<span class="n">memset</span><span class="p">(</span><span class="n">is_arrived</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">is_arrived</span><span class="p">));</span>

<span class="n">fin</span> <span class="o">&gt;&gt;</span> <span class="n">Source</span> <span class="o">&gt;&gt;</span> <span class="n">Vertex</span><span class="p">;</span>
<span class="k">for</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">p</span><span class="o">&lt;=</span><span class="n">Vertex</span><span class="p">;</span><span class="n">p</span><span class="o">++</span><span class="p">)</span>
<span class="k">for</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">q</span><span class="o">&lt;=</span><span class="n">Vertex</span><span class="p">;</span><span class="n">q</span><span class="o">++</span><span class="p">)</span>
<span class="p">{</span>
<span class="n">fin</span> <span class="o">&gt;&gt;</span> <span class="n">Map</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="n">q</span><span class="p">];</span>
<span class="k">if</span> <span class="p">(</span><span class="n">Map</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="n">q</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="n">Map</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="n">q</span><span class="p">]</span><span class="o">=</span><span class="n">MaxNum</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">for</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">p</span><span class="o">&lt;=</span><span class="n">Vertex</span><span class="p">;</span><span class="n">p</span><span class="o">++</span><span class="p">)</span>
<span class="p">{</span>
<span class="n">Dist</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">=</span><span class="n">Map</span><span class="p">[</span><span class="n">Source</span><span class="p">][</span><span class="n">p</span><span class="p">];</span>
<span class="k">if</span> <span class="p">(</span><span class="n">Dist</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">!=</span><span class="n">MaxNum</span><span class="p">)</span> 
<span class="n">From</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">=</span><span class="n">Source</span><span class="p">;</span>
<span class="k">else</span> 
<span class="n">From</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">=</span><span class="n">p</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">is_arrived</span><span class="p">[</span><span class="n">Source</span><span class="p">]</span><span class="o">=</span><span class="nb">true</span><span class="p">;</span>
<span class="n">SetCard</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="k">do</span>
<span class="p">{</span>
<span class="n">Temp</span><span class="o">=</span><span class="n">FindMin</span><span class="p">();</span>
<span class="k">if</span> <span class="p">(</span><span class="n">Temp</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="n">SetCard</span><span class="o">=</span><span class="n">SetCard</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
<span class="n">is_arrived</span><span class="p">[</span><span class="n">Temp</span><span class="p">]</span><span class="o">=</span><span class="nb">true</span><span class="p">;</span>
<span class="k">for</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">p</span><span class="o">&lt;=</span><span class="n">Vertex</span><span class="p">;</span><span class="n">p</span><span class="o">++</span><span class="p">)</span>
<span class="k">if</span> <span class="p">((</span><span class="n">Dist</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">&gt;</span><span class="n">Dist</span><span class="p">[</span><span class="n">Temp</span><span class="p">]</span><span class="o">+</span><span class="n">Map</span><span class="p">[</span><span class="n">Temp</span><span class="p">][</span><span class="n">p</span><span class="p">])</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="o">!</span><span class="n">is_arrived</span><span class="p">[</span><span class="n">p</span><span class="p">]))</span>
<span class="p">{</span>
<span class="n">Dist</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">=</span><span class="n">Dist</span><span class="p">[</span><span class="n">Temp</span><span class="p">]</span><span class="o">+</span><span class="n">Map</span><span class="p">[</span><span class="n">Temp</span><span class="p">][</span><span class="n">p</span><span class="p">];</span>
<span class="n">From</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">=</span><span class="n">Temp</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="k">else</span>
<span class="k">break</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">while</span> <span class="p">(</span><span class="n">SetCard</span><span class="o">!=</span><span class="n">Vertex</span><span class="p">);</span>

<span class="k">for</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">p</span><span class="o">&lt;=</span><span class="n">Vertex</span><span class="p">;</span><span class="n">p</span><span class="o">++</span><span class="p">)</span>
<span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="o">!=</span><span class="n">Source</span><span class="p">)</span>
<span class="p">{</span>
<span class="n">fout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;========================</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="n">fout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Source:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Source</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Target:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">p</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="n">Dist</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">==</span><span class="n">MaxNum</span><span class="p">)</span>
<span class="p">{</span>
<span class="n">fout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Distance:&quot;</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Infinity</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="n">fout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Path:No Way!&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">else</span>
<span class="p">{</span> 
<span class="n">fout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Distance:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Dist</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
<span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="n">Path</span><span class="o">=</span><span class="n">p</span><span class="p">;</span>
<span class="k">while</span> <span class="p">(</span><span class="n">From</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span><span class="o">!=</span><span class="n">Path</span><span class="p">)</span>
<span class="p">{</span>
<span class="n">Stack</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">Path</span><span class="p">;</span>
<span class="n">Path</span><span class="o">=</span><span class="n">From</span><span class="p">[</span><span class="n">Path</span><span class="p">];</span>
<span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">fout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Path:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Source</span><span class="p">;</span>
<span class="k">for</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">q</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">;</span><span class="n">q</span><span class="o">--</span><span class="p">)</span>
<span class="n">fout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;--&gt;&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Stack</span><span class="p">[</span><span class="n">q</span><span class="p">];</span>
<span class="p">}</span>
<span class="n">fout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">========================</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">fin</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
<span class="n">fout</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h2 id="2"><img alt="ğŸ’¯" class="emojione" src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/png/1f4af.png" title=":100:" /> 2.æ•°å€¼æ¦‚ç‡ç®—æ³•å’Œèˆä¼å¾·ç®—æ³•ã€‚<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<h2 id="3">3.ç°è‰²é¢„æµ‹<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<p>è¿™æ˜¯åƒçº¿æ€§å›å½’ä¸€ä¸‹ï¼Œå»ºç«‹èµ·ä¸€ä¸ªé¢„æµ‹æ¨¡å‹ï¼Œç„¶åè¿›è¡Œé¢„æµ‹æœªçŸ¥æ•°æ®</p>
<p>ä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨ç°è‰²é¢„æµ‹æ¨¡å‹ï¼Ÿ</p>
<p><strong>æ•°æ®é‡å°ï¼Œé¢„æµ‹çš„å‘¨æœŸçŸ­ï¼Œé¢„æµ‹çš„é•¿åº¦çŸ­</strong></p>
<p>åˆ†ä¸ºGM(1,1)ï¼ŒGM(1,m)ï¼ŒGM(n,m)åˆ†åˆ«ç”¨äºä¸€ä¸ªè‡ªå˜é‡ä¸€ä¸ªå› å˜é‡ï¼Œå¤šä¸ªè‡ªå˜é‡ä¸€ä¸ªå› å˜é‡ï¼Œå¤šä¸ªè‡ªå˜é‡å¤šä¸ªå› å˜é‡</p>
<p>è¿™é‡Œæœ‰ä¸¤ä¸ªç¨‹åºï¼Œæœ‰ä¸€ä¸ªç®€å•ç‰ˆæœ¬ï¼Œæœ‰ä¸€ä¸ªå¤æ‚ç‰ˆæœ¬ï¼Œå¤æ‚ç‰ˆæœ¬è¯·å‚è€ƒgithub</p>
<div class="highlight"><pre><span></span><code><span class="k">function</span><span class="w"> </span>[]<span class="p">=</span><span class="nf">greymodel</span><span class="p">(</span>y<span class="p">)</span><span class="w"></span>
<span class="c">% æœ¬ç¨‹åºä¸»è¦ç”¨æ¥è®¡ç®—æ ¹æ®ç°è‰²ç†è®ºå»ºç«‹çš„æ¨¡å‹çš„é¢„æµ‹å€¼ã€‚</span>
<span class="c">% åº”ç”¨çš„æ•°å­¦æ¨¡å‹æ˜¯ GM(1,1)ã€‚</span>
<span class="c">% åŸå§‹æ•°æ®çš„å¤„ç†æ–¹æ³•æ˜¯ä¸€æ¬¡ç´¯åŠ æ³•ã€‚</span>
<span class="n">y</span><span class="p">=</span><span class="n">input</span><span class="p">(</span><span class="s">&#39;è¯·è¾“å…¥æ•°æ® &#39;</span><span class="p">);</span>
<span class="n">n</span><span class="p">=</span><span class="nb">length</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
<span class="n">yy</span><span class="p">=</span><span class="nb">ones</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">yy</span><span class="p">(</span><span class="mi">1</span><span class="p">)=</span><span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="n">for</span> <span class="s">i=2:n</span>
    <span class="n">yy</span><span class="p">(</span><span class="nb">i</span><span class="p">)=</span><span class="n">yy</span><span class="p">(</span><span class="nb">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="p">);</span>
<span class="n">end</span>
<span class="s">B=ones(n-1,2)</span><span class="p">;</span>
<span class="n">for</span> <span class="s">i=1:(n-1)</span>
    <span class="n">B</span><span class="p">(</span><span class="nb">i</span><span class="p">,</span><span class="mi">1</span><span class="p">)=</span><span class="o">-</span><span class="p">(</span><span class="n">yy</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="o">+</span><span class="n">yy</span><span class="p">(</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
    <span class="n">B</span><span class="p">(</span><span class="nb">i</span><span class="p">,</span><span class="mi">2</span><span class="p">)=</span><span class="mi">1</span><span class="p">;</span>
<span class="n">end</span>
<span class="s">BT=B&#39;;</span>
<span class="s">for j=1:n-1</span>
<span class="s">    YN(j)=y(j+1);</span>
<span class="s">end</span>
<span class="s">YN=YN&#39;</span><span class="p">;</span>
<span class="n">A</span><span class="p">=</span><span class="n">inv</span><span class="p">(</span><span class="n">BT</span><span class="o">*</span><span class="n">B</span><span class="p">)</span><span class="o">*</span><span class="n">BT</span><span class="o">*</span><span class="n">YN</span><span class="p">;</span>
<span class="n">a</span><span class="p">=</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="n">u</span><span class="p">=</span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">t</span><span class="p">=</span><span class="n">u</span><span class="o">/</span><span class="n">a</span><span class="p">;</span>
<span class="nb">i</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">;</span>
<span class="n">yys</span><span class="p">(</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)=(</span><span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">t</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="o">.*</span><span class="nb">i</span><span class="p">)</span><span class="o">+</span><span class="n">t</span><span class="p">;</span>
<span class="n">yys</span><span class="p">(</span><span class="mi">1</span><span class="p">)=</span><span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="n">for</span> <span class="s">j=n+2:-1:2</span>
    <span class="n">ys</span><span class="p">(</span><span class="nb">j</span><span class="p">)=</span><span class="n">yys</span><span class="p">(</span><span class="nb">j</span><span class="p">)</span><span class="o">-</span><span class="n">yys</span><span class="p">(</span><span class="nb">j</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="n">end</span>
<span class="s">x=1:n</span><span class="p">;</span>
<span class="n">xs</span><span class="p">=</span><span class="mi">2</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">;</span>
<span class="n">yn</span><span class="p">=</span><span class="n">ys</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">);</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s">&#39;^r&#39;</span><span class="p">,</span><span class="n">xs</span><span class="p">,</span><span class="n">yn</span><span class="p">,</span><span class="s">&#39;*-b&#39;</span><span class="p">);</span>
<span class="n">det</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span>

<span class="n">sum1</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span>
<span class="n">sumpe</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span>
<span class="n">for</span> <span class="s">i=1:n</span>
    <span class="n">sumpe</span><span class="p">=</span><span class="n">sumpe</span><span class="o">+</span><span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="p">);</span>
<span class="n">end</span>
<span class="s">pe=sumpe/n</span><span class="p">;</span>
<span class="n">for</span> <span class="s">i=1:n</span><span class="p">;</span>
    <span class="n">sum1</span><span class="p">=</span><span class="n">sum1</span><span class="o">+</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="o">-</span><span class="n">pe</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span><span class="p">;</span>
<span class="n">end</span>
<span class="s">s1=sqrt(sum1/n)</span><span class="p">;</span>
<span class="n">sumce</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span>
<span class="n">for</span> <span class="s">i=2:n</span>
    <span class="n">sumce</span><span class="p">=</span><span class="n">sumce</span><span class="o">+</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="o">-</span><span class="n">yn</span><span class="p">(</span><span class="nb">i</span><span class="p">));</span>
<span class="n">end</span>
<span class="s">ce=sumce/(n-1)</span><span class="p">;</span>
<span class="n">sum2</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span>
<span class="n">for</span> <span class="s">i=2:n</span><span class="p">;</span>
    <span class="n">sum2</span><span class="p">=</span><span class="n">sum2</span><span class="o">+</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="o">-</span><span class="n">yn</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="o">-</span><span class="n">ce</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span><span class="p">;</span>
<span class="n">end</span>
<span class="s">s2=sqrt(sum2/(n-1))</span><span class="p">;</span>
<span class="n">c</span><span class="p">=(</span><span class="n">s2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">s1</span><span class="p">);</span>
<span class="nb">disp</span><span class="p">([</span><span class="s">&#39;åéªŒå·®æ¯”å€¼ä¸ºï¼š&#39;</span><span class="p">,</span><span class="n">num2str</span><span class="p">(</span><span class="n">c</span><span class="p">)]);</span>
<span class="n">if</span> <span class="s">c&lt;0.35</span>
    <span class="nb">disp</span><span class="p">(</span><span class="s">&#39;ç³»ç»Ÿé¢„æµ‹ç²¾åº¦å¥½&#39;</span><span class="p">)</span>
<span class="k">else</span> <span class="k">if</span> <span class="n">c</span><span class="o">&lt;</span><span class="mf">0.5</span>
        <span class="nb">disp</span><span class="p">(</span><span class="s">&#39;ç³»ç»Ÿé¢„æµ‹ç²¾åº¦åˆæ ¼&#39;</span><span class="p">)</span>
    <span class="n">else</span> <span class="s">if</span> <span class="s">c&lt;0.65</span>
            <span class="nb">disp</span><span class="p">(</span><span class="s">&#39;ç³»ç»Ÿé¢„æµ‹ç²¾åº¦å‹‰å¼º&#39;</span><span class="p">)</span>
        <span class="n">else</span>
            <span class="s">disp(&#39;ç³»ç»Ÿé¢„æµ‹ç²¾åº¦ä¸åˆæ ¼&#39;)</span>
        <span class="n">end</span>
    <span class="s">end</span>
<span class="k">end</span>

<span class="nb">disp</span><span class="p">([</span><span class="s">&#39;ä¸‹ä¸ªæ‹Ÿåˆå€¼ä¸º &#39;</span><span class="p">,</span><span class="n">num2str</span><span class="p">(</span><span class="n">ys</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))]);</span>
<span class="nb">disp</span><span class="p">([</span><span class="s">&#39;å†ä¸‹ä¸ªæ‹Ÿåˆå€¼ä¸º&#39;</span><span class="p">,</span><span class="n">num2str</span><span class="p">(</span><span class="n">ys</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">))]);</span>
</code></pre></div>

<h2 id="4">4.èšç±»ç®—æ³•<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<p>å°±æ˜¯å°†æ•°æ®åˆ†ä¸ºkç±»ï¼Œæˆ‘ä»¬è¿™é‡Œç”¨kmeansï¼Œ</p>
<p>æ¯”å¦‚å°†æ•°æ®åˆ†æˆ4ç±»ï¼šï¼Œè¿™é‡Œçš„æ ·æœ¬ä»¥å‰éƒ½æ˜¯é»‘è‰²çš„ï¼Œæˆ‘ä»¬è®¤ä¸ºè®¾å®šk=4ï¼Œå°±æ˜¯åˆ†ä¸º4ç±»ä»¥åå¾—åˆ°çš„åˆ†ç±»ç»“æœ</p>
<p><img alt="image-20200723183009694" src="https://gitee.com/moluggg/image/raw/master/img/202007/23/183011-843982.png" /></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>


<span class="c1"># calculate Euclidean distance</span>
<span class="k">def</span> <span class="nf">euclDistance</span><span class="p">(</span><span class="n">vector1</span><span class="p">,</span> <span class="n">vector2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">power</span><span class="p">(</span><span class="n">vector2</span> <span class="o">-</span> <span class="n">vector1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>

<span class="c1"># init centroids with random samples</span>
<span class="k">def</span> <span class="nf">initCentroids</span><span class="p">(</span><span class="n">dataSet</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">numSamples</span><span class="p">,</span> <span class="n">dim</span> <span class="o">=</span> <span class="n">dataSet</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">centroids</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="n">dim</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="n">index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">numSamples</span><span class="p">))</span>
        <span class="n">centroids</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">dataSet</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="p">:]</span>
    <span class="k">return</span> <span class="n">centroids</span>

<span class="c1"># k-means cluster</span>
<span class="k">def</span> <span class="nf">kmeans</span><span class="p">(</span><span class="n">dataSet</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">numSamples</span> <span class="o">=</span> <span class="n">dataSet</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># first column stores which cluster this sample belongs to,</span>
    <span class="c1"># second column stores the error between this sample and its centroid</span>
    <span class="n">clusterAssment</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="n">zeros</span><span class="p">((</span><span class="n">numSamples</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
    <span class="n">clusterChanged</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1">## step 1: init centroids</span>
    <span class="n">centroids</span> <span class="o">=</span> <span class="n">initCentroids</span><span class="p">(</span><span class="n">dataSet</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>

    <span class="k">while</span> <span class="n">clusterChanged</span><span class="p">:</span>
        <span class="n">clusterChanged</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1">## for each sample</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">numSamples</span><span class="p">):</span>
            <span class="n">minDist</span>  <span class="o">=</span> <span class="mf">100000.0</span>
            <span class="n">minIndex</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="c1">## for each centroid</span>
            <span class="c1">## step 2: find the centroid who is closest</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                <span class="n">distance</span> <span class="o">=</span> <span class="n">euclDistance</span><span class="p">(</span><span class="n">centroids</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:],</span> <span class="n">dataSet</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span>
                <span class="k">if</span> <span class="n">distance</span> <span class="o">&lt;</span> <span class="n">minDist</span><span class="p">:</span>
                    <span class="n">minDist</span>  <span class="o">=</span> <span class="n">distance</span>
                    <span class="n">minIndex</span> <span class="o">=</span> <span class="n">j</span>

            <span class="c1">## step 3: update its cluster</span>
            <span class="k">if</span> <span class="n">clusterAssment</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">minIndex</span><span class="p">:</span>
                <span class="n">clusterChanged</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">clusterAssment</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">minIndex</span><span class="p">,</span> <span class="n">minDist</span><span class="o">**</span><span class="mi">2</span>

        <span class="c1">## step 4: update centroids</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
            <span class="n">pointsInCluster</span> <span class="o">=</span> <span class="n">dataSet</span><span class="p">[</span><span class="n">nonzero</span><span class="p">(</span><span class="n">clusterAssment</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">A</span> <span class="o">==</span> <span class="n">j</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">centroids</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">pointsInCluster</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

    <span class="nb">print</span> <span class="s1">&#39;Congratulations, cluster complete!&#39;</span>
    <span class="k">return</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">clusterAssment</span>

<span class="c1"># show your cluster only available with 2-D data</span>
<span class="k">def</span> <span class="nf">showCluster</span><span class="p">(</span><span class="n">dataSet</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">clusterAssment</span><span class="p">):</span>
    <span class="n">numSamples</span><span class="p">,</span> <span class="n">dim</span> <span class="o">=</span> <span class="n">dataSet</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">if</span> <span class="n">dim</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="nb">print</span> <span class="s2">&quot;Sorry! I can not draw because the dimension of your data is not 2!&quot;</span>
        <span class="k">return</span> <span class="mi">1</span>

    <span class="n">mark</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;or&#39;</span><span class="p">,</span> <span class="s1">&#39;ob&#39;</span><span class="p">,</span> <span class="s1">&#39;og&#39;</span><span class="p">,</span> <span class="s1">&#39;ok&#39;</span><span class="p">,</span> <span class="s1">&#39;^r&#39;</span><span class="p">,</span> <span class="s1">&#39;+r&#39;</span><span class="p">,</span> <span class="s1">&#39;sr&#39;</span><span class="p">,</span> <span class="s1">&#39;dr&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;r&#39;</span><span class="p">,</span> <span class="s1">&#39;pr&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">mark</span><span class="p">):</span>
        <span class="nb">print</span> <span class="s2">&quot;Sorry! Your k is too large! please contact Zouxy&quot;</span>
        <span class="k">return</span> <span class="mi">1</span>

    <span class="c1"># draw all samples</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">numSamples</span><span class="p">):</span>
        <span class="n">markIndex</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">clusterAssment</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dataSet</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dataSet</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">mark</span><span class="p">[</span><span class="n">markIndex</span><span class="p">])</span>

    <span class="n">mark</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Dr&#39;</span><span class="p">,</span> <span class="s1">&#39;Db&#39;</span><span class="p">,</span> <span class="s1">&#39;Dg&#39;</span><span class="p">,</span> <span class="s1">&#39;Dk&#39;</span><span class="p">,</span> <span class="s1">&#39;^b&#39;</span><span class="p">,</span> <span class="s1">&#39;+b&#39;</span><span class="p">,</span> <span class="s1">&#39;sb&#39;</span><span class="p">,</span> <span class="s1">&#39;db&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;b&#39;</span><span class="p">,</span> <span class="s1">&#39;pb&#39;</span><span class="p">]</span>
    <span class="c1"># draw the centroids</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">centroids</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">centroids</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">mark</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">markersize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#æµ‹è¯•ä»£ç ï¼š</span>


<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1">## step 1: load data</span>
<span class="nb">print</span> <span class="s2">&quot;step 1: load data...&quot;</span>
<span class="n">dataSet</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1">##################################ä¿®æ”¹##########################</span>
<span class="n">fileIn</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;E:/Python/Machine Learning in Action/testSet.txt&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fileIn</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
    <span class="n">lineArr</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">dataSet</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">lineArr</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">lineArr</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>

<span class="c1">## step 2: clustering...</span>
<span class="nb">print</span> <span class="s2">&quot;step 2: clustering...&quot;</span>
<span class="n">dataSet</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="n">dataSet</span><span class="p">)</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">centroids</span><span class="p">,</span> <span class="n">clusterAssment</span> <span class="o">=</span> <span class="n">kmeans</span><span class="p">(</span><span class="n">dataSet</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>

<span class="c1">## step 3: show the result</span>
<span class="nb">print</span> <span class="s2">&quot;step 3: show the result...&quot;</span>
<span class="n">showCluster</span><span class="p">(</span><span class="n">dataSet</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">clusterAssment</span><span class="p">)</span>
</code></pre></div>

<p>æ•°æ®æ–‡ä»¶é•¿è¿™ä¸ªæ ·å­</p>
<p><img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://gitee.com/moluggg/image/raw/master/img/202007/23/183142-836169.png" /></p>
<h2 id="5">5.è’™ç‰¹å¡æ´›<a class="headerlink" href="#5" title="Permanent link">&para;</a></h2>
<h2 id="6">6.æ¨¡æ‹Ÿé€€ç«<a class="headerlink" href="#6" title="Permanent link">&para;</a></h2>
<p>åŠŸèƒ½ï¼š</p>
<p>å¯»æ‰¾å…¨å±€æœ€ä¼˜å€¼ï¼ˆå¯»æ‰¾æœ€å°å€¼æˆ–è€…æœ€å¤§å€¼ï¼‰</p>
<p>ä¾‹é¢˜ï¼š</p>
<p>TSPæœ€çŸ­è·¯å¾„</p>
<p>åŸºæœ¬æ€æƒ³ï¼š</p>
<p>æ˜¯è´ªå¿ƒç®—æ³•ï¼Œåœ¨æœç´¢è¿‡ç¨‹ä¸­åŠ å…¥éšæœºæ‰°åŠ¨ï¼Œå¦‚æœæ‰¾åˆ°ä¸€ä¸ªæ›´æ¥è¿‘æœ€ä¼˜å€¼çš„ç‚¹ï¼Œæ¥å—è¯¥è§£ã€‚å¦åˆ™ï¼Œä»¥ä¸€å®šçš„æ¦‚ç‡æ¥æ”¶ä¸€ä¸ªæ¯”å½“å‰è§£è¦å·®çš„è§£ï¼Œé˜²æ­¢é™·å…¥å±€éƒ¨æœ€ä¼˜è§£ï¼Œ**åšåˆ°æ›´åŠ æ¥è¿‘æœ€ä¼˜å€¼ã€‚**æ¨¡æ‹Ÿé€€ç«è¿‡ç¨‹ï¼Œåˆå§‹æ¸©åº¦æœ€é«˜ï¼Œéšç€æœç´¢çš„è¿‡ç¨‹ï¼Œæ¸©åº¦è¶Šä½ï¼Œå†…èƒ½å‡å°ï¼Œæœç´¢èŒƒå›´è¶‹äºç¨³å®šã€‚</p>
<p>ç®—æ³•æ­¥éª¤ï¼šï¼ˆä»¥æœ€å°å€¼ä¸ºä¾‹ï¼‰</p>
<p><strong>Step1.</strong>  è®¾ç½®åˆå§‹æ¸©åº¦<span><span class="MathJax_Preview">t_{k}=t_{max}</span><script type="math/tex">t_{k}=t_{max}</script></span>,å½“å‰è¿­ä»£æ­¥æ•°<span><span class="MathJax_Preview">k=0</span><script type="math/tex">k=0</script></span> ï¼Œèµ·ç‚¹<span><span class="MathJax_Preview">x=x_{0}</span><script type="math/tex">x=x_{0}</script></span></p>
<p><strong>Step2.</strong>  å¾—åˆ°æ–°è§£ <span><span class="MathJax_Preview">x_{new }= x+\Delta x</span><script type="math/tex">x_{new }= x+\Delta x</script></span>    å…¶ä¸­ <span><span class="MathJax_Preview">\Delta x</span><script type="math/tex">\Delta x</script></span>åœ¨[dmin,dmax]ä¹‹é—´</p>
<p><strong>Step3.</strong>  <span><span class="MathJax_Preview">dE = f(x_{new})- f(x)</span><script type="math/tex">dE = f(x_{new})- f(x)</script></span> ï¼Œæˆ‘ä¸­<span><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span>æ˜¯ä¼˜åŒ–ç›®æ ‡</p>
<p><strong>Step4.</strong>  è‹¥$dE &gt;0 $ åˆ™æ¥å—è¯¥ç‚¹ï¼Œå¦åˆ™ï¼Œä»¥æ¦‚ç‡<span><span class="MathJax_Preview">\exp (-dE/(k T))</span><script type="math/tex">\exp (-dE/(k T))</script></span>æ¥å—è¯¥ç‚¹ï¼›å¹¶é™æ¸©ã€‚</p>
<blockquote>
<p><strong>Step4.</strong>  è‹¥$dE &lt;0 $ åˆ™æ¥å—è¯¥ç‚¹ï¼Œå¦åˆ™ï¼Œä»¥æ¦‚ç‡<span><span class="MathJax_Preview">\exp (dE/(k T))</span><script type="math/tex">\exp (dE/(k T))</script></span>æ¥å—è¯¥ç‚¹(æœ€å¤§å€¼)</p>
</blockquote>
<p>è¿™æ ·ä¸€ç›´é‡å¤2,3,4ä¸€ç›´è¾¾åˆ°é˜ˆå€¼æ¸©åº¦ç»“æŸ</p>
<div class="highlight"><pre><span></span><code><span class="k">function</span> <span class="nf">main</span>
<span class="n">clc</span>
<span class="s">clear</span><span class="p">;</span>

<span class="c">%èŒƒå›´</span>
<span class="n">section_l</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">section_h</span> <span class="p">=</span> <span class="mi">9</span><span class="p">;</span>

<span class="c">%ç»˜åˆ¶å‡½æ•°å›¾åƒ</span>
<span class="n">draw_base</span><span class="p">();</span>

<span class="c">%åˆå§‹æ¸©åº¦ï¼Œåœæ­¢æ¸©åº¦ä¸é™æ¸©ç³»æ•°</span>
<span class="n">tmp</span> <span class="p">=</span> <span class="mf">1e5</span><span class="p">;</span>
<span class="n">tmp_min</span> <span class="p">=</span> <span class="mf">1e-3</span><span class="p">;</span>
<span class="n">alpha</span> <span class="p">=</span> <span class="mf">0.98</span><span class="p">;</span>

<span class="c">%ç”Ÿæˆåˆå§‹éšæœºè§£</span>
<span class="n">x_old</span> <span class="p">=</span> <span class="p">(</span><span class="n">section_h</span> <span class="o">-</span> <span class="n">section_l</span><span class="p">)</span> <span class="o">*</span> <span class="nb">rand</span><span class="p">()</span> <span class="o">+</span> <span class="n">section_l</span><span class="p">;</span>
<span class="n">x_new</span> <span class="p">=</span> <span class="n">x_old</span><span class="p">;</span>
<span class="n">s_old</span> <span class="p">=</span> <span class="n">val</span><span class="p">(</span><span class="n">x_old</span><span class="p">);</span>
<span class="n">s_new</span> <span class="p">=</span> <span class="n">s_old</span><span class="p">;</span>

<span class="n">text_lt</span> <span class="p">=</span> <span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;Init&#39;</span><span class="p">);</span>

<span class="c">%è®¡æ•°å™¨</span>
<span class="n">counter</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="c">%é€€ç«çš„ä¸»ä½“éƒ¨åˆ†ï¼Œä¸€ä¸ªå¾ªç¯</span>
<span class="k">while</span><span class="p">(</span><span class="n">tmp</span> <span class="o">&gt;</span> <span class="n">tmp_min</span><span class="p">)</span>  <span class="c">%é˜ˆå€¼æ¸©åº¦</span>
  <span class="c">%éšæœºæ‰°åŠ¨</span>
  <span class="n">delta</span> <span class="p">=</span> <span class="p">(</span><span class="nb">rand</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span><span class="p">;</span>
  <span class="n">x_new</span> <span class="p">=</span> <span class="n">x_old</span> <span class="o">+</span> <span class="n">delta</span><span class="p">;</span>
  <span class="c">%æ‰°åŠ¨çš„å€¼å°äºä¸€åŠçš„åŒºé—´èŒƒå›´æ—¶ï¼Œå¯ä»¥ç”¨è¿™ç§åŠæ³•é˜²æ­¢æ–°å€¼è¶…å‡ºåŒºé—´èŒƒå›´</span>
  <span class="k">if</span><span class="p">(</span><span class="n">x_new</span> <span class="o">&lt;</span> <span class="n">section_l</span> <span class="o">||</span> <span class="n">x_new</span> <span class="o">&gt;</span> <span class="n">section_h</span><span class="p">)</span>
    <span class="n">x_new</span> <span class="p">=</span> <span class="n">x_new</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">delta</span><span class="p">;</span>
  <span class="n">end</span>

  <span class="s">s_new</span> <span class="s">=</span> <span class="s">val(x_new)</span><span class="p">;</span>

  <span class="c">%æ±‚å·®å€¼ï¼Œè¿™é‡Œæ˜¯æ‰¾æœ€å¤§å€¼è€Œéæœ€å°å€¼ï¼Œæ‰€ä»¥ä¸æ˜¯s_new - s_old    3</span>
  <span class="n">dE</span> <span class="p">=</span> <span class="n">s_old</span> <span class="o">-</span> <span class="n">s_new</span><span class="p">;</span>

  <span class="c">%åˆ¤æ–­ï¼Œæ˜¯å¦æ¥å—è¯¥ç‚¹    4 </span>
  <span class="nb">j</span> <span class="p">=</span> <span class="n">judge</span><span class="p">(</span><span class="n">dE</span><span class="p">,</span> <span class="n">tmp</span><span class="p">);</span> 
  <span class="k">if</span><span class="p">(</span><span class="nb">j</span><span class="p">)</span>
    <span class="n">s_old</span> <span class="p">=</span> <span class="n">s_new</span><span class="p">;</span>
    <span class="n">x_old</span> <span class="p">=</span> <span class="n">x_new</span><span class="p">;</span>
  <span class="n">end</span>

  <span class="s">%åªæœ‰å½“dE</span> <span class="s">&lt;</span> <span class="s">0çš„æƒ…å†µä¸‹æ‰é™æ¸©</span> 
  <span class="k">if</span><span class="p">(</span><span class="n">dE</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">delete</span><span class="p">(</span><span class="n">text_lt</span><span class="p">);</span>
    <span class="n">hold</span> <span class="s">on,</span> <span class="s">scatter(x_old,</span> <span class="s">s_old)</span><span class="p">;</span>
    <span class="n">hold</span> <span class="s">on,</span> <span class="s">text_lt</span> <span class="s">=</span> <span class="s">text(0.3,</span> <span class="s">21,</span> <span class="s">[&#39;tmp: &#39;,</span> <span class="s">num2str(tmp)])</span><span class="p">;</span>
    <span class="n">pause</span><span class="p">(</span><span class="mf">0.01</span><span class="p">);</span>
    <span class="c">%ä¸Šé¢æ˜¯ç»˜å›¾çš„ä»£ç ï¼Œä¸‹é¢é™æ¸©</span>
    <span class="n">tmp</span> <span class="p">=</span> <span class="n">tmp</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">;</span>
  <span class="n">else</span>
    <span class="s">counter</span> <span class="s">=</span> <span class="s">counter</span> <span class="s">+</span> <span class="s">1</span><span class="p">;</span>
  <span class="n">end</span>

  <span class="s">%å½“æ¥å—æ›´å·®çš„è§£çš„æ¦‚ç‡å¤ªå°æ—¶ï¼Œè‹¥åˆé•¿æ—¶é—´æ‰¾ä¸åˆ°æ›´ä¼˜çš„è§£ï¼Œé‚£ä¹ˆé€€å‡ºå¾ªç¯ï¼Œç»“æŸç®—æ³•</span>
  <span class="k">if</span><span class="p">(</span><span class="n">counter</span> <span class="o">&gt;</span> <span class="mi">10000</span><span class="p">)</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="n">end</span>

<span class="s">end</span>
<span class="k">end</span>
<span class="k">function</span><span class="w"> </span>[y] <span class="p">=</span><span class="w"> </span><span class="nf">val</span><span class="p">(</span>x<span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">y</span> <span class="p">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">7</span> <span class="o">*</span> <span class="nb">cos</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">x</span><span class="p">);</span>
<span class="n">end</span>

<span class="s">function</span> <span class="s">draw_base()</span>
    <span class="n">X</span> <span class="p">=</span> <span class="mi">0</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">:</span><span class="mi">9</span><span class="p">;</span>
    <span class="n">M</span> <span class="p">=</span> <span class="n">val</span><span class="p">(</span><span class="n">X</span><span class="p">);</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">M</span><span class="p">);</span>
<span class="n">end</span>
<span class="s">function</span> <span class="s">[y]</span> <span class="s">=</span> <span class="s">judge(dE,</span> <span class="s">t)</span>
  <span class="k">if</span><span class="p">(</span><span class="n">dE</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">y</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">else</span>
    <span class="s">d</span> <span class="s">=</span> <span class="s">exp(-(dE</span> <span class="s">/</span> <span class="s">t))</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">d</span> <span class="o">&gt;</span> <span class="nb">rand</span><span class="p">)</span>
      <span class="n">y</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">else</span>
      <span class="s">y</span> <span class="s">=</span> <span class="s">0</span><span class="p">;</span>
    <span class="n">end</span>
  <span class="s">end</span>
<span class="k">end</span>
</code></pre></div>

<p><a href="https://zhuanlan.zhihu.com/p/33184423">https://zhuanlan.zhihu.com/p/33184423</a></p>
<p>ä¼˜ç¼ºç‚¹ï¼š</p>
<p>æ¸©åº¦ç®¡ç†é—®é¢˜æ˜¯ä¸€ä¸ªéš¾ä»¥å¤„ç†çš„é—®é¢˜ï¼Œå®é™…åº”ç”¨ä¸­ï¼Œç”±äºå¿…é¡»è€ƒè™‘è®¡ç®—å¤æ‚åº¦çš„åˆ‡å®å¯è¡Œæ€§ç­‰é—®é¢˜ï¼Œå¾ˆå®¹æ˜“å—åˆ°å‚æ•°çš„å½±å“</p>
<p>å…·æœ‰å±€éƒ¨æœç´¢èƒ½åŠ›å¼ºã€è¿è¡Œæ—¶é—´çŸ­çš„ä¼˜ç‚¹</p>
<p>ä¾‹é¢˜ï¼š 110è­¦è½¦é…ç½®</p>
<p>æ€è·¯ï¼šå›¾è®ºé—®é¢˜ï¼Œç®€åŒ–é—®é¢˜ï¼Œå°†å›¾ç»“ç‚¹ä¿ç•™ï¼Œè¾¹ä¿¡æ¯ä¿ç•™ï¼Œç”±å›¾è½¬åŒ–æˆé‚»æ¥çŸ©é˜µçš„é—®é¢˜</p>
<p><img alt="image-20200726111233676" src="https://gitee.com/moluggg/image/raw/master/img/202007/26/111234-101527.png" /></p>
<h2 id="7">7.é—ä¼ ç®—æ³•<a class="headerlink" href="#7" title="Permanent link">&para;</a></h2>
<p>åŠŸèƒ½ï¼šä¹Ÿæ˜¯å¯»æ‰¾æœ€ä¼˜å€¼æ–¹æ¡ˆçš„ç®—æ³•</p>
<p>æ‰€ä»¥æ±‚æœ€å¤§å€¼çš„è¿‡ç¨‹å°±è½¬åŒ–æˆä¸€ä¸ªâ€œè¢‹é¼ è·³â€çš„è¿‡ç¨‹ã€‚**</p>
<p>ä¸‹é¢ä»‹ç»ä»‹ç»â€œè¢‹é¼ è·³â€çš„å‡ ç§æ–¹å¼ã€‚</p>
<ul>
<li>çˆ¬å±±ç®—æ³•ï¼šä¸€åªè¢‹é¼ æœç€æ¯”ç°åœ¨é«˜çš„åœ°æ–¹è·³å»ã€‚å®ƒæ‰¾åˆ°äº†ä¸è¿œå¤„çš„æœ€é«˜çš„å±±å³°ã€‚ä½†æ˜¯è¿™åº§å±±ä¸ä¸€å®šæ˜¯æœ€é«˜å³°ã€‚è¿™å°±æ˜¯çˆ¬å±±ç®—æ³•ï¼Œå®ƒä¸èƒ½ä¿è¯å±€éƒ¨æœ€ä¼˜å€¼å°±æ˜¯å…¨å±€æœ€ä¼˜å€¼ã€‚</li>
<li>æ¨¡æ‹Ÿé€€ç«ï¼šè¢‹é¼ å–é†‰äº†ã€‚å®ƒéšæœºåœ°è·³äº†å¾ˆé•¿æ—¶é—´ã€‚è¿™æœŸé—´ï¼Œå®ƒå¯èƒ½èµ°å‘é«˜å¤„ï¼Œä¹Ÿå¯èƒ½è¸å…¥å¹³åœ°ã€‚ä½†æ˜¯ï¼Œå®ƒæ¸æ¸æ¸…é†’äº†å¹¶æœæœ€é«˜å³°è·³å»ã€‚è¿™å°±æ˜¯æ¨¡æ‹Ÿé€€ç«ç®—æ³•ã€‚</li>
<li>é—ä¼ ç®—æ³•ï¼šæœ‰å¾ˆå¤šè¢‹é¼ ï¼Œå®ƒä»¬é™è½åˆ°å–œç›æ‹‰é›…å±±è„‰çš„ä»»æ„åœ°æ–¹ã€‚è¿™äº›è¢‹é¼ å¹¶ä¸çŸ¥é“å®ƒä»¬çš„ä»»åŠ¡æ˜¯å¯»æ‰¾ç ç©†æœ—ç›å³°ã€‚ä½†æ¯è¿‡å‡ å¹´ï¼Œå°±åœ¨ä¸€äº›æµ·æ‹”é«˜åº¦è¾ƒä½çš„åœ°æ–¹å°„æ€ä¸€äº›è¢‹é¼ ã€‚äºæ˜¯ï¼Œä¸æ–­æœ‰è¢‹é¼ æ­»äºæµ·æ‹”è¾ƒä½çš„åœ°æ–¹ï¼Œè€Œè¶Šæ˜¯åœ¨æµ·æ‹”é«˜çš„è¢‹é¼ è¶Šæ˜¯èƒ½æ´»å¾—æ›´ä¹…ï¼Œä¹Ÿè¶Šæœ‰æœºä¼šç”Ÿå„¿è‚²å¥³ã€‚å°±è¿™æ ·ç»è¿‡è®¸å¤šå¹´ï¼Œè¿™äº›è¢‹é¼ ä»¬ç«Ÿç„¶éƒ½ä¸è‡ªè§‰åœ°èšæ‹¢åˆ°äº†ä¸€ä¸ªä¸ªçš„å±±å³°ä¸Šï¼Œå¯æ˜¯åœ¨æ‰€æœ‰çš„è¢‹é¼ ä¸­ï¼Œåªæœ‰èšæ‹¢åˆ°ç ç©†æœ—ç›å³°çš„è¢‹é¼ è¢«å¸¦å›äº†ç¾ä¸½çš„æ¾³æ´²ã€‚</li>
</ul>
<p><a href="https://blog.csdn.net/JX_Cesare/article/details/81268771">https://blog.csdn.net/JX_Cesare/article/details/81268771</a></p>
<p><a href="https://www.jianshu.com/p/ae5157c26af9">https://www.jianshu.com/p/ae5157c26af9</a></p>
<p>åŸºæœ¬æ€æƒ³ï¼šé€‚è€…ç”Ÿå­˜ï¼ˆæ¥è¿‘æœ€ä¼˜å€¼çš„ï¼‰ï¼ŒåŠ£è€…æ·˜æ±°ï¼ˆæ¯éš”ä¸€æ®µæ—¶é—´æ·˜æ±°æ‰ä¸€äº›ç»“ç‚¹ï¼‰</p>
<p>å¹¶éµå¾ªé—ä¼ ä¸­çš„åŸºå› é—ä¼ ï¼Œå˜å¼‚ï¼Œäº¤é…äº§ç”Ÿåä»£</p>
<p>hå‡½æ•°è¿˜æ˜¯æ²¡æœ‰å¤ªçœ‹æ‡‚</p>
<p>ç®—æ³•æ­¥éª¤ï¼š</p>
<ol>
<li>
<p>ç¼–ç ï¼ˆè®¾è®¡åŸºå› ç‰‡æ®µï¼‰</p>
</li>
<li>
<p>è®¾è®¡é€‚åº”åº¦å‡½æ•°ï¼Œä¸€ä¸ªç›®æ ‡å‡½æ•°</p>
</li>
<li>é€‰æ‹©ï¼ˆè½®ç›˜èµŒï¼šæ ¹æ®è‡ªèº«çš„ä¼˜åŠ¿æŠŠæ‰€æœ‰ç§ç¾¤æ”¾åœ¨0-1ä¹‹é—´é€‰æ‹©ï¼Œéšæœºç«äº‰ï¼Œæœ€ä½³ä¿ç•™ç­‰ç®—æ³•ï¼‰</li>
<li>é—ä¼ ï¼ˆæŸ“è‰²ä½“äº¤å‰ï¼‰åŸºå› ç‰‡æ®µçš„äº¤æ¢</li>
<li>å˜å¼‚</li>
</ol>
<p>è½®ç›˜èµŒï¼š</p>
<p><img alt="image-20200725175759649" src="https://gitee.com/moluggg/image/raw/master/img/202007/25/175801-996578.png" /></p>
<div class="highlight"><pre><span></span><code><span class="k">function</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="n">clear</span><span class="p">;</span>
<span class="n">clc</span><span class="p">;</span>
<span class="c">%ç§ç¾¤å¤§å°</span>
<span class="n">popsize</span><span class="p">=</span><span class="mi">100</span><span class="p">;</span>
<span class="c">%äºŒè¿›åˆ¶ç¼–ç é•¿åº¦</span>
<span class="n">chromlength</span><span class="p">=</span><span class="mi">10</span><span class="p">;</span>
<span class="c">%äº¤å‰æ¦‚ç‡</span>
<span class="n">pc</span> <span class="p">=</span> <span class="mf">0.6</span><span class="p">;</span>
<span class="c">%å˜å¼‚æ¦‚ç‡</span>
<span class="n">pm</span> <span class="p">=</span> <span class="mf">0.001</span><span class="p">;</span>
<span class="c">%åˆå§‹ç§ç¾¤</span>
<span class="n">pop</span> <span class="p">=</span> <span class="n">initpop</span><span class="p">(</span><span class="n">popsize</span><span class="p">,</span><span class="n">chromlength</span><span class="p">);</span>

<span class="n">for</span> <span class="s">i</span> <span class="s">=</span> <span class="s">1:100</span>
    <span class="c">%è®¡ç®—é€‚åº”åº¦å€¼ï¼ˆå‡½æ•°å€¼ï¼‰</span>
    <span class="n">objvalue</span> <span class="p">=</span> <span class="n">cal_objvalue</span><span class="p">(</span><span class="n">pop</span><span class="p">);</span>
    <span class="n">fitvalue</span> <span class="p">=</span> <span class="n">objvalue</span><span class="p">;</span>
    <span class="c">%é€‰æ‹©æ“ä½œ</span>
    <span class="n">newpop</span> <span class="p">=</span> <span class="n">selection</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span><span class="n">fitvalue</span><span class="p">);</span>
    <span class="c">%äº¤å‰æ“ä½œ</span>
    <span class="n">newpop</span> <span class="p">=</span> <span class="n">crossover</span><span class="p">(</span><span class="n">newpop</span><span class="p">,</span><span class="n">pc</span><span class="p">);</span>
    <span class="c">%å˜å¼‚æ“ä½œ</span>
    <span class="n">newpop</span> <span class="p">=</span> <span class="n">mutation</span><span class="p">(</span><span class="n">newpop</span><span class="p">,</span><span class="n">pm</span><span class="p">);</span>
    <span class="c">%æ›´æ–°ç§ç¾¤</span>
    <span class="n">pop</span> <span class="p">=</span> <span class="n">newpop</span><span class="p">;</span>
    <span class="c">%å¯»æ‰¾æœ€ä¼˜è§£</span>
    <span class="p">[</span><span class="n">bestindividual</span><span class="p">,</span><span class="n">bestfit</span><span class="p">]</span> <span class="p">=</span> <span class="n">best</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span><span class="n">fitvalue</span><span class="p">);</span>
    <span class="n">x2</span> <span class="p">=</span> <span class="n">binary2decimal</span><span class="p">(</span><span class="n">bestindividual</span><span class="p">);</span>
    <span class="n">x1</span> <span class="p">=</span> <span class="n">binary2decimal</span><span class="p">(</span><span class="n">newpop</span><span class="p">);</span>
    <span class="n">y1</span> <span class="p">=</span> <span class="n">cal_objvalue</span><span class="p">(</span><span class="n">newpop</span><span class="p">);</span>
    <span class="n">if</span> <span class="s">mod(i,10)</span> <span class="s">==</span> <span class="s">0</span>
        <span class="n">figure</span><span class="p">;</span>
        <span class="n">fplot</span><span class="p">(</span><span class="s">&#39;10*sin(5*x)+7*abs(x-5)+10&#39;</span><span class="p">,[</span><span class="mi">0</span> <span class="mi">10</span><span class="p">]);</span>
        <span class="n">hold</span> <span class="s">on</span><span class="p">;</span>
        <span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="s">&#39;*&#39;</span><span class="p">);</span>
        <span class="n">title</span><span class="p">([</span><span class="s">&#39;è¿­ä»£æ¬¡æ•°ä¸ºn=&#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="nb">i</span><span class="p">)]);</span>
        <span class="c">%plot(x1,y1,&#39;*&#39;);</span>
    <span class="n">end</span>
<span class="s">end</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;The best X is ---&gt;&gt;%5.2f\n&#39;</span><span class="p">,</span><span class="n">x2</span><span class="p">);</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;The best Y is ---&gt;&gt;%5.2f\n&#39;</span><span class="p">,</span><span class="n">bestfit</span><span class="p">);</span>
</code></pre></div>

<h2 id="8">8.ç²’å­ç¾¤ç®—æ³•<a class="headerlink" href="#8" title="Permanent link">&para;</a></h2>
<h2 id="9">9.ç§ç¾¤ç«äº‰ï¼š<a class="headerlink" href="#9" title="Permanent link">&para;</a></h2>
<h2 id="10">10.æ’é˜Ÿè®ºï¼š<a class="headerlink" href="#10" title="Permanent link">&para;</a></h2>
<h2 id="11">11.å±‚æ¬¡åˆ†æï¼š<a class="headerlink" href="#11" title="Permanent link">&para;</a></h2>
<p>åšå†³ç­–ï¼š</p>
<p><img alt="img" src="E:\typoraå›¾ç‰‡\v2-08ab75dabd1234a80b74cb1bd1105df7_720w.jpg" /></p>
<h2 id="12">12.å¤šå…ƒå›å½’ï¼š<a class="headerlink" href="#12" title="Permanent link">&para;</a></h2>
<h2 id="13">13.ä¸»æˆåˆ†åˆ†æï¼š<a class="headerlink" href="#13" title="Permanent link">&para;</a></h2>
<p>å¯¹äºäºŒç»´æ•°æ®è€Œè¨€ï¼š</p>
<table>
<thead>
<tr>
<th><img alt="image-20200726113919926" src="https://gitee.com/moluggg/image/raw/master/img/202007/26/113949-282365.png" /></th>
<th><img alt="image-20200726112600558" src="https://gitee.com/moluggg/image/raw/master/img/202007/26/113942-122991.png" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>åŸå§‹æ•°æ®</td>
<td>å°†åŸå§‹æ•°æ®æ±‚è´¨ç‚¹çš„æ•°æ®åˆ†å¸ƒ</td>
</tr>
</tbody>
</table>
<p>è¿™æ ·æ±‚å‡ºæ¥çš„æ•°æ®ï¼Œ<span><span class="MathJax_Preview">\bar{X},\bar{Y}=0</span><script type="math/tex">\bar{X},\bar{Y}=0</script></span>ä¾¿äºä»¥ä¸‹çš„è®¡ç®—</p>
<p>x,yè½´ä¸Šçš„æ–¹å·®ä¸åæ–¹å·®å…¬å¼ï¼š</p>
<div>
<div class="MathJax_Preview">
\begin{array}{c}
s^{2}(X)=\frac{\sum_{i=1}^{n}\left(X_{i}-\bar{X}\right)^{2}}{n-1} \\
s^{2}\left(D_{1}\right)=18.97 \\
s^{2}\left(D_{2}\right)=3.13 \\
\operatorname{cov}(X, Y)=\frac{\sum_{i-1}^{n}\left(X_{i}-\bar{X}\right)\left(Y_{i}-\bar{Y}\right)}{n-1} \\
\operatorname{cov}\left(D_{1}, D_{2}\right)=6.49
\end{array}
</div>
<script type="math/tex; mode=display">
\begin{array}{c}
s^{2}(X)=\frac{\sum_{i=1}^{n}\left(X_{i}-\bar{X}\right)^{2}}{n-1} \\
s^{2}\left(D_{1}\right)=18.97 \\
s^{2}\left(D_{2}\right)=3.13 \\
\operatorname{cov}(X, Y)=\frac{\sum_{i-1}^{n}\left(X_{i}-\bar{X}\right)\left(Y_{i}-\bar{Y}\right)}{n-1} \\
\operatorname{cov}\left(D_{1}, D_{2}\right)=6.49
\end{array}
</script>
</div>
<p><strong>å®é™…ä¸Šå¯ä»¥è¡¨ç¤ºä¸ºï¼š</strong></p>
<div>
<div class="MathJax_Preview">
\begin{aligned}
C=\left[\begin{array}{ll}
s^{2}(X) &amp; \operatorname{cov}(X Y) \\
\operatorname{cov}(X Y) &amp; s^{2}(Y)
\end{array}\right]=\left[\begin{array}{cc}
18.97 &amp; 6.49 \\
6.49 &amp; 3.13
\end{array}\right] \\
&amp;=\frac{1}{6-1} A^{T} A
\end{aligned}
</div>
<script type="math/tex; mode=display">
\begin{aligned}
C=\left[\begin{array}{ll}
s^{2}(X) & \operatorname{cov}(X Y) \\
\operatorname{cov}(X Y) & s^{2}(Y)
\end{array}\right]=\left[\begin{array}{cc}
18.97 & 6.49 \\
6.49 & 3.13
\end{array}\right] \\
&=\frac{1}{6-1} A^{T} A
\end{aligned}
</script>
</div>
<p>å…¶ä¸­ï¼Œ$A  $æ˜¯ä»¥è´¨å¿ƒä¸ºï¼ˆ0,0ï¼‰çš„å¤„ç†åçš„æ•°æ® ï¼Œå½¢çŠ¶ä¸º 4*2</p>
<p>æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯é‡æ–°å¯»æ‰¾ä¸€ä¸ªæ–¹å‘ï¼Œä½¿å¾—è¿™äº›ç‚¹è®©åœ¨è¿™ä¸ªæ–¹å‘ä¸Šåˆ†æ•£å¾—æœ€å¼€ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨è¿™ä¸ªæ–¹å‘ä¸Šï¼Œç‚¹åˆ°ä¸­å¿ƒåŸç‚¹çš„æ–¹å·®æœ€å¤§ã€‚</p>
<div>
<div class="MathJax_Preview">
\begin{array}{c}
S=\vec{a} \cdot \vec{v}=|a||v| \cos \theta=|a| \cos \theta \\
s^{2}=\sum_{i=1}^{n} \frac{S^{2}}{n-1}=\frac{\vec{v} \cdot \vec{A}^{T} \cdot\left(\vec{v} \cdot \vec{A}^{T}\right)^{T}}{n-1} \\
=\vec{v} \cdot \frac{\vec{A}^{T} \vec{A}}{n-1} \cdot \vec{v}^{T} \\
=\vec{v} C \vec{v}^{T}
\end{array}
</div>
<script type="math/tex; mode=display">
\begin{array}{c}
S=\vec{a} \cdot \vec{v}=|a||v| \cos \theta=|a| \cos \theta \\
s^{2}=\sum_{i=1}^{n} \frac{S^{2}}{n-1}=\frac{\vec{v} \cdot \vec{A}^{T} \cdot\left(\vec{v} \cdot \vec{A}^{T}\right)^{T}}{n-1} \\
=\vec{v} \cdot \frac{\vec{A}^{T} \vec{A}}{n-1} \cdot \vec{v}^{T} \\
=\vec{v} C \vec{v}^{T}
\end{array}
</script>
</div>
<p>æ„é€  ç›®æ ‡å‡½æ•°ä»¥åŠ çº¦æŸå‡½æ•°ï¼Œåˆ©ç”¨æ‹‰æ ¼æœ—æ—¥å®šç†,æ±‚è§£ï¼š</p>
<p>$$
\begin{array}{l}
J=s^{2}=\vec{v} C \vec{v}^{T} \
\text {s.t.} \vec{v} \cdot \vec{v}^{T}=1 \
F(\vec{v})=\vec{v} C \vec{v}^{T}-\lambda\left(1-\vec{v} \cdot \vec{v}^{T}\right)
\end{array}
$$
<img alt="image-20200726114911807" src="https://gitee.com/moluggg/image/raw/master/img/202007/26/114938-645529.png" /></p>
<p>æ±‚æœ€å€¼ä¹‹åä¼šå¾—åˆ°ä¸€ä¸ªç‰¹å¾å€¼å…¬å¼ï¼š</p>
<div>
<div class="MathJax_Preview">
\begin{array}{c}
\frac{\partial F(\vec{v})}{\partial \vec{v}}=0 \\
2 C v^{T}-2 \lambda v^{T}=0 \\
C v^{T}=\lambda v^{T}
\end{array}
</div>
<script type="math/tex; mode=display">
\begin{array}{c}
\frac{\partial F(\vec{v})}{\partial \vec{v}}=0 \\
2 C v^{T}-2 \lambda v^{T}=0 \\
C v^{T}=\lambda v^{T}
\end{array}
</script>
</div>
<p>ç„¶åç‰¹å¾å€¼åˆ†è§£ä¼šå¾—åˆ°ä¸¤ä¸ªç›¸äº’ç‹¬ç«‹çš„å‘é‡ï¼ˆçº¿æ€§ä»£æ•°æœ‰æ±‚è§£è¿‡ç¨‹ï¼‰</p>
<table>
<thead>
<tr>
<th><img alt="image-20200726115215898" src="https://gitee.com/moluggg/image/raw/master/img/202007/26/115216-408997.png" /></th>
<th><img alt="image-20200726115155432" src="https://gitee.com/moluggg/image/raw/master/img/202007/26/115223-541960.png" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>æ±‚è§£çš„ä¸¤ä¸ªå‘é‡</td>
<td>è¡¨ç¤ºå’±å›¾ä¸­</td>
</tr>
</tbody>
</table>
<p><span><span class="MathJax_Preview">\lambda</span><script type="math/tex">\lambda</script></span>çš„å«ä¹‰ï¼šå¸¦å…¥åˆ°å…¬å¼ï¼ˆ2ï¼‰æ­¤æ—¶ï¼ŒCv=<span><span class="MathJax_Preview">\lambda v</span><script type="math/tex">\lambda v</script></span> å¸¦å…¥å¯å¾—ï¼Œç”±äº<span><span class="MathJax_Preview">\lambda</span><script type="math/tex">\lambda</script></span>æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œå¯ä»¥æå‡ºæ¥ï¼Œ<span><span class="MathJax_Preview">v^{T}v=1</span><script type="math/tex">v^{T}v=1</script></span></p>
<p>æ‰€ä»¥  <span><span class="MathJax_Preview">s^{2}= \lambda</span><script type="math/tex">s^{2}= \lambda</script></span></p>
<p>æœ€åå¾—åˆ°çš„ä¸¤ä¸ªæ–¹å‘ï¼šä¿¡æ¯é›†ä¸­åˆ°äº†ä¸€ä¸ªæ–¹å‘é‡Œé¢ï¼Œå› æ­¤ä¸»æˆåˆ†åˆ†æé™ç»´æŠ€æœ¯ï¼Œå°†ä¿¡æ¯å°‘çš„ç»´åº¦çœå»</p>
<p><img alt="image-20200726115717782" src="E:\typoraå›¾ç‰‡\image-20200726115717782.png" /></p>
<p>ä¾‹é¢˜ï¼š</p>
<p><img alt="img" src="https://gitee.com/moluggg/image/raw/master/img/202007/26/115943-499677.jpeg" /></p>
<div class="highlight"><pre><span></span><code><span class="n">clc</span>
<span class="s">clear</span> <span class="s">all</span>
<span class="n">A</span><span class="p">=</span><span class="n">xlsread</span><span class="p">(</span><span class="s">&#39;è¿™é‡Œæ¢æˆä½ è‡ªå·±çš„æ•°æ®æ ¹ç›®å½•ï¼Œä¾‹å¦‚ï¼šD:\èµ„æ–™åº“åŒº\å¤§ä¸‰ä¸Š\HUAWEI\MATLAB\ä¸»æˆåˆ†åˆ†æ.xls&#39;</span><span class="p">,</span><span class="s">&#39;B3:I17&#39;</span><span class="p">);</span>
<span class="c">%å¾—åˆ°çš„æ•°æ®çŸ©é˜µçš„è¡Œæ•°å’Œåˆ—æ•°</span>
<span class="n">a</span><span class="p">=</span><span class="nb">size</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">b</span><span class="p">=</span><span class="nb">size</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="c">%æ•°æ®çš„æ ‡å‡†åŒ–å¤„ç†:å¾—åˆ°æ ‡å‡†åŒ–åçš„çŸ©é˜µSA</span>
<span class="k">for</span> <span class="nb">i</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="n">b</span>
    <span class="n">SA</span><span class="p">(:,</span><span class="nb">i</span><span class="p">)=(</span><span class="n">A</span><span class="p">(:,</span><span class="nb">i</span><span class="p">)</span><span class="o">-</span><span class="n">mean</span><span class="p">(</span><span class="n">A</span><span class="p">(:,</span><span class="nb">i</span><span class="p">)))</span><span class="o">/</span><span class="n">std</span><span class="p">(</span><span class="n">A</span><span class="p">(:,</span><span class="nb">i</span><span class="p">));</span>
<span class="n">end</span>
<span class="s">%è®¡ç®—ç³»æ•°çŸ©é˜µ:CM</span>
<span class="n">CM</span><span class="p">=</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">SA</span><span class="p">);</span>
<span class="c">%è®¡ç®—CMçš„ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡</span>
<span class="p">[</span><span class="n">V</span><span class="p">,</span><span class="n">D</span><span class="p">]=</span><span class="n">eig</span><span class="p">(</span><span class="n">CM</span><span class="p">);</span>
<span class="c">%å°†ç‰¹å¾å€¼æŒ‰é™åºæ’åˆ—åˆ°DSä¸­</span>
<span class="k">for</span> <span class="nb">j</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="n">b</span>
    <span class="n">DS</span><span class="p">(</span><span class="nb">j</span><span class="p">,</span><span class="mi">1</span><span class="p">)=</span><span class="n">D</span><span class="p">(</span><span class="n">b</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="nb">j</span><span class="p">,</span><span class="n">b</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="nb">j</span><span class="p">);</span>
<span class="n">end</span>
<span class="s">%è®¡ç®—è´¡çŒ®ç‡</span>
<span class="k">for</span> <span class="nb">i</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="n">b</span>
    <span class="n">DS</span><span class="p">(</span><span class="nb">i</span><span class="p">,</span><span class="mi">2</span><span class="p">)=</span><span class="n">DS</span><span class="p">(</span><span class="nb">i</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">sum</span><span class="p">(</span><span class="n">DS</span><span class="p">(:,</span><span class="mi">1</span><span class="p">));</span><span class="c">%å•ä¸ªè´¡çŒ®ç‡</span>
    <span class="n">DS</span><span class="p">(</span><span class="nb">i</span><span class="p">,</span><span class="mi">3</span><span class="p">)=</span><span class="n">sum</span><span class="p">(</span><span class="n">DS</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">i</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">sum</span><span class="p">(</span><span class="n">DS</span><span class="p">(:,</span><span class="mi">1</span><span class="p">));</span><span class="c">%ç´¯è®¡è´¡çŒ®ç‡</span>
<span class="k">end</span>
<span class="c">%å‡å®šä¸»æˆåˆ†çš„ä¿¡æ¯ä¿ç•™ç‡</span>
<span class="n">T</span><span class="p">=</span><span class="mf">0.9</span><span class="p">;</span>
<span class="n">for</span> <span class="s">k=1:b</span>
    <span class="n">if</span> <span class="s">DS(k,3)</span> <span class="s">&gt;=</span> <span class="s">T</span>
        <span class="n">com_num</span><span class="p">=</span><span class="n">k</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="n">end</span>
<span class="s">end</span>
<span class="c">%æå–ä¸»æˆåˆ†çš„ç‰¹å¾å‘é‡</span>
<span class="k">for</span> <span class="nb">j</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="n">com_num</span>
    <span class="n">PV</span><span class="p">(:,</span><span class="nb">j</span><span class="p">)=</span><span class="n">V</span><span class="p">(:,</span><span class="n">b</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="nb">j</span><span class="p">);</span>
<span class="n">end</span>
<span class="s">%è®¡ç®—ä¸»æˆåˆ†å¾—åˆ†</span>
<span class="n">new_score</span><span class="p">=</span><span class="n">SA</span><span class="o">*</span><span class="n">PV</span><span class="p">;</span>
<span class="n">for</span> <span class="s">i=1:a</span>
    <span class="n">total_score</span><span class="p">(</span><span class="nb">i</span><span class="p">,</span><span class="mi">1</span><span class="p">)=</span><span class="n">sum</span><span class="p">(</span><span class="n">new_score</span><span class="p">(</span><span class="nb">i</span><span class="p">,:));</span>
    <span class="n">total_score</span><span class="p">(</span><span class="nb">i</span><span class="p">,</span><span class="mi">2</span><span class="p">)=</span><span class="nb">i</span><span class="p">;</span>
<span class="n">end</span>
<span class="s">%å¼ºä¸»æˆåˆ†å¾—åˆ†ä¸æ€»åˆ†æ”¾åˆ°åŒä¸€ä¸ªçŸ©é˜µä¸­</span>
<span class="n">result_report</span><span class="p">=[</span><span class="n">new_score</span><span class="p">,</span><span class="n">total_score</span><span class="p">];</span>
<span class="c">%æŒ‰æ€»åˆ†é™åºæ’åˆ—</span>
<span class="n">result_report</span><span class="p">=</span><span class="n">sortrows</span><span class="p">(</span><span class="n">result_report</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">);</span>
<span class="c">%è¾“å‡ºç»“æœ</span>
<span class="nb">disp</span><span class="p">(</span><span class="s">&#39;ç‰¹å¾å€¼ã€è´¡çŒ®ç‡ã€ç´¯è®¡è´¡çŒ®ç‡ï¼š&#39;</span><span class="p">)</span>
<span class="n">DS</span>
<span class="s">disp(&#39;ä¿¡æ¯ä¿ç•™ç‡Tå¯¹åº”çš„ä¸»æˆåˆ†æ•°ä¸ç‰¹å¾å‘é‡ï¼š&#39;)</span>
<span class="n">com_num</span>
<span class="s">PV</span>
<span class="nb">disp</span><span class="p">(</span><span class="s">&#39;ä¸»æˆåˆ†å¾—åˆ†åŠæ’åºï¼ˆæŒ‰ç¬¬4åˆ—çš„æ€»åˆ†è¿›è¡Œé™åºæ’åˆ—ï¼Œå‰3åˆ—ä¸ºä¸ªå„æˆåˆ†å¾—åˆ†ï¼Œç¬¬5åˆ—ä¸ºä¼ä¸šç¼–å·ï¼‰&#39;</span><span class="p">)</span>
<span class="n">result_report</span>

<span class="s">å¯ä»¥ç”¨ä¸‹æ–¹æ•°æ®è®­ç»ƒä¸€ä¸‹</span>
</code></pre></div>

<h2 id="14">14.ç¥ç»ç½‘ç»œ<a class="headerlink" href="#14" title="Permanent link">&para;</a></h2>
<p><strong>ç¥ç»ç½‘ç»œçš„æ™®é€šåº”ç”¨ï¼šå›å½’ä¸åˆ†ç±»</strong></p>
<h3 id="221">ç¥ç»ç½‘ç»œï¼ˆ2,2,1ï¼‰ç»“æ„<a class="headerlink" href="#221" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1">#è¿™æ˜¯ä¸€å±‚ç¥ç»ç½‘ç»œçš„æ„é€ ï¼š</span>
<span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
  <span class="c1"># Our activation function: f(x) = 1 / (1 + e^(-x))</span>
  <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>

<span class="k">class</span> <span class="nc">Neuron</span><span class="p">:</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">bias</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">weights</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="n">bias</span>

  <span class="k">def</span> <span class="nf">feedforward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
    <span class="c1"># Weight inputs, add bias, then use the activation function</span>
    <span class="n">total</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">,</span> <span class="n">inputs</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span>
    <span class="k">return</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">total</span><span class="p">)</span>

<span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="c1"># w1 = 0, w2 = 1</span>
<span class="n">bias</span> <span class="o">=</span> <span class="mi">4</span>                   <span class="c1"># b = 4</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">Neuron</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">bias</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>       <span class="c1"># x1 = 2, x2 = 3</span>
<span class="nb">print</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">feedforward</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>    <span class="c1"># 0.9990889488055994</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>0.9990889488055994
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># ... code from previous section here</span>

<span class="k">class</span> <span class="nc">OurNeuralNetwork</span><span class="p">:</span>
  <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  A neural network with:</span>
<span class="sd">    - 2 inputs</span>
<span class="sd">    - a hidden layer with 2 neurons (h1, h2)</span>
<span class="sd">    - an output layer with 1 neuron (o1)</span>
<span class="sd">  Each neuron has the same weights and bias:</span>
<span class="sd">    - w = [0, 1]</span>
<span class="sd">    - b = 0</span>
<span class="sd">  &#39;&#39;&#39;</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">bias</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># The Neuron class here is from the previous section</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">h1</span> <span class="o">=</span> <span class="n">Neuron</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">bias</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">h2</span> <span class="o">=</span> <span class="n">Neuron</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">bias</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">o1</span> <span class="o">=</span> <span class="n">Neuron</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">bias</span><span class="p">)</span> <span class="c1">#åˆå§‹åŒ–</span>

  <span class="k">def</span> <span class="nf">feedforward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">out_h1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h1</span><span class="o">.</span><span class="n">feedforward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1">#å‰å‘ä¼ æ’­</span>
    <span class="n">out_h2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h2</span><span class="o">.</span><span class="n">feedforward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="c1"># The inputs for o1 are the outputs from h1 and h2</span>
    <span class="n">out_o1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">o1</span><span class="o">.</span><span class="n">feedforward</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">out_h1</span><span class="p">,</span> <span class="n">out_h2</span><span class="p">]))</span>

    <span class="k">return</span> <span class="n">out_o1</span>

<span class="n">network</span> <span class="o">=</span> <span class="n">OurNeuralNetwork</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">network</span><span class="o">.</span><span class="n">feedforward</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="c1"># 0.7216325609518421</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>0.7216325609518421
</code></pre></div>


<p><img alt="image-20200725163502982" src="https://gitee.com/moluggg/image/raw/master/img/202007/26/121228-640748.png" /></p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
  <span class="c1"># Sigmoid activation function: f(x) = 1 / (1 + e^(-x))</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">deriv_sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="c1"># Derivative of sigmoid: f&#39;(x) = f(x) * (1 - f(x))</span>
    <span class="n">fx</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fx</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">fx</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">mse_loss</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
  <span class="c1"># y_true and y_pred are numpy arrays of the same length.</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">y_true</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">OurNeuralNetwork</span><span class="p">:</span> <span class="c1">#è¿™ä¸ªç¥ç»ç½‘ç»œåªæ˜¯ç”¨äºæœ‰2ä¸¤ä¸ªè¾“å…¥ï¼Œä¸€ä¸ªéšè—å±‚ï¼ˆå«æœ‰2ä¸ªç»“ç‚¹ï¼‰ï¼Œä¸€ä¸ªè¾“å‡ºçš„ç®€å•çš„ç¥ç»ç½‘ç»œ</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># æƒé‡ï¼ŒWeights</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w6</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">()</span>

        <span class="c1"># æˆªè·é¡¹ï¼ŒBiases</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">feedforward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="c1"># x is a numpy array with 2 elements.</span>
        <span class="n">h1</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w1</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">w2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">b1</span><span class="p">)</span>
        <span class="n">h2</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w3</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">w4</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">b2</span><span class="p">)</span>
        <span class="n">o1</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w5</span> <span class="o">*</span> <span class="n">h1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">w6</span> <span class="o">*</span> <span class="n">h2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">b3</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">o1</span>

    <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">all_y_trues</span><span class="p">):</span> <span class="c1">#l=é‡Œé¢æ¶‰åŠåˆ°åå‘æ¢¯åº¦æ›´æ–°ä¼ æ’­ç®—æ³•</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        - data is a (n x 2) numpy array, n = # of samples in the dataset.</span>
<span class="sd">        - all_y_trues is a numpy array with n elements.</span>
<span class="sd">          Elements in all_y_trues correspond to those in data.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">learn_rate</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="n">epochs</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># number of times to loop through the entire dataset</span>

        <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>

            <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y_true</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">all_y_trues</span><span class="p">):</span>


                <span class="c1"># --- Do a feedforward (we&#39;ll need these values later) æ¯ä¸€æ¬¡çš„å‰å‘ä¼ æ’­ï¼Œå¯ä»¥ç”¨feedforwardä»£æ›¿</span>
                <span class="n">sum_h1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w1</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">w2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">b1</span>
                <span class="n">h1</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">sum_h1</span><span class="p">)</span>

                <span class="n">sum_h2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w3</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">w4</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">b2</span>
                <span class="n">h2</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">sum_h2</span><span class="p">)</span>

                <span class="n">sum_o1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w5</span> <span class="o">*</span> <span class="n">h1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">w6</span> <span class="o">*</span> <span class="n">h2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">b3</span>
                <span class="n">o1</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">sum_o1</span><span class="p">)</span>
                <span class="n">y_pred</span> <span class="o">=</span> <span class="n">o1</span>
                <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">                h1,h2,o1 =OurNeuralNetwork.feedforward(data)   #ç±»çš„ä½¿ç”¨è¿˜ä¸å¤ªä¼š</span>
<span class="sd">                y_pred = o1</span>
<span class="sd">                &#39;&#39;&#39;</span>

                <span class="c1"># --- Calculate partial derivatives.</span>
                <span class="c1"># --- Naming: d_L_d_w1 represents &quot;partial L / partial w1&quot;</span>
                <span class="n">d_L_d_ypred</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">y_true</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span>

                <span class="c1"># Neuron o1</span>
                <span class="n">d_ypred_d_w5</span> <span class="o">=</span> <span class="n">h1</span> <span class="o">*</span> <span class="n">deriv_sigmoid</span><span class="p">(</span><span class="n">sum_o1</span><span class="p">)</span>
                <span class="n">d_ypred_d_w6</span> <span class="o">=</span> <span class="n">h2</span> <span class="o">*</span> <span class="n">deriv_sigmoid</span><span class="p">(</span><span class="n">sum_o1</span><span class="p">)</span>
                <span class="n">d_ypred_d_b3</span> <span class="o">=</span> <span class="n">deriv_sigmoid</span><span class="p">(</span><span class="n">sum_o1</span><span class="p">)</span>

                <span class="n">d_ypred_d_h1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w5</span> <span class="o">*</span> <span class="n">deriv_sigmoid</span><span class="p">(</span><span class="n">sum_o1</span><span class="p">)</span>
                <span class="n">d_ypred_d_h2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w6</span> <span class="o">*</span> <span class="n">deriv_sigmoid</span><span class="p">(</span><span class="n">sum_o1</span><span class="p">)</span>

                <span class="c1"># Neuron h1</span>
                <span class="n">d_h1_d_w1</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">deriv_sigmoid</span><span class="p">(</span><span class="n">sum_h1</span><span class="p">)</span>
                <span class="n">d_h1_d_w2</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">deriv_sigmoid</span><span class="p">(</span><span class="n">sum_h1</span><span class="p">)</span>
                <span class="n">d_h1_d_b1</span> <span class="o">=</span> <span class="n">deriv_sigmoid</span><span class="p">(</span><span class="n">sum_h1</span><span class="p">)</span>

                <span class="c1"># Neuron h2</span>
                <span class="n">d_h2_d_w3</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">deriv_sigmoid</span><span class="p">(</span><span class="n">sum_h2</span><span class="p">)</span>
                <span class="n">d_h2_d_w4</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">deriv_sigmoid</span><span class="p">(</span><span class="n">sum_h2</span><span class="p">)</span>
                <span class="n">d_h2_d_b2</span> <span class="o">=</span> <span class="n">deriv_sigmoid</span><span class="p">(</span><span class="n">sum_h2</span><span class="p">)</span>

                <span class="c1"># --- Update weights and biases</span>
                <span class="c1"># Neuron h1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">w1</span> <span class="o">-=</span> <span class="n">learn_rate</span> <span class="o">*</span> <span class="n">d_L_d_ypred</span> <span class="o">*</span> <span class="n">d_ypred_d_h1</span> <span class="o">*</span> <span class="n">d_h1_d_w1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">w2</span> <span class="o">-=</span> <span class="n">learn_rate</span> <span class="o">*</span> <span class="n">d_L_d_ypred</span> <span class="o">*</span> <span class="n">d_ypred_d_h1</span> <span class="o">*</span> <span class="n">d_h1_d_w2</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">b1</span> <span class="o">-=</span> <span class="n">learn_rate</span> <span class="o">*</span> <span class="n">d_L_d_ypred</span> <span class="o">*</span> <span class="n">d_ypred_d_h1</span> <span class="o">*</span> <span class="n">d_h1_d_b1</span>

                <span class="c1"># Neuron h2</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">w3</span> <span class="o">-=</span> <span class="n">learn_rate</span> <span class="o">*</span> <span class="n">d_L_d_ypred</span> <span class="o">*</span> <span class="n">d_ypred_d_h2</span> <span class="o">*</span> <span class="n">d_h2_d_w3</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">w4</span> <span class="o">-=</span> <span class="n">learn_rate</span> <span class="o">*</span> <span class="n">d_L_d_ypred</span> <span class="o">*</span> <span class="n">d_ypred_d_h2</span> <span class="o">*</span> <span class="n">d_h2_d_w4</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">b2</span> <span class="o">-=</span> <span class="n">learn_rate</span> <span class="o">*</span> <span class="n">d_L_d_ypred</span> <span class="o">*</span> <span class="n">d_ypred_d_h2</span> <span class="o">*</span> <span class="n">d_h2_d_b2</span>

                <span class="c1"># Neuron o1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">w5</span> <span class="o">-=</span> <span class="n">learn_rate</span> <span class="o">*</span> <span class="n">d_L_d_ypred</span> <span class="o">*</span> <span class="n">d_ypred_d_w5</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">w6</span> <span class="o">-=</span> <span class="n">learn_rate</span> <span class="o">*</span> <span class="n">d_L_d_ypred</span> <span class="o">*</span> <span class="n">d_ypred_d_w6</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">b3</span> <span class="o">-=</span> <span class="n">learn_rate</span> <span class="o">*</span> <span class="n">d_L_d_ypred</span> <span class="o">*</span> <span class="n">d_ypred_d_b3</span>

          <span class="c1"># --- Calculate total loss at the end of each epoch</span>
        <span class="k">if</span> <span class="n">epoch</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">y_preds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feedforward</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">mse_loss</span><span class="p">(</span><span class="n">all_y_trues</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Epoch </span><span class="si">%d</span><span class="s2"> loss: </span><span class="si">%.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="n">loss</span><span class="p">))</span>

<span class="c1"># Define dataset</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
  <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>  <span class="c1"># Alice</span>
  <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>   <span class="c1"># Bob</span>
  <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>   <span class="c1"># Charlie</span>
  <span class="p">[</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">],</span> <span class="c1"># Diana</span>
<span class="p">])</span>
<span class="n">all_y_trues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
  <span class="mi">1</span><span class="p">,</span> <span class="c1"># Alice</span>
  <span class="mi">0</span><span class="p">,</span> <span class="c1"># Bob</span>
  <span class="mi">0</span><span class="p">,</span> <span class="c1"># Charlie</span>
  <span class="mi">1</span><span class="p">,</span> <span class="c1"># Diana</span>
<span class="p">])</span>

<span class="c1"># Train our neural network!</span>
<span class="n">network</span> <span class="o">=</span> <span class="n">OurNeuralNetwork</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">network</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">all_y_trues</span><span class="p">))</span>
</code></pre></div>

<p><img alt="image-20200725163508715" src="https://gitee.com/moluggg/image/raw/master/img/202007/26/121233-970393.png" /></p>
<p><img alt="image-20200801093306281" src="E:\typoraå›¾ç‰‡\image-20200801093306281.png" /></p>
<p><img alt="image-20200801093317595" src="E:\typoraå›¾ç‰‡\image-20200801093317595.png" /></p>
<p><img alt="image-20200801093451450" src="https://gitee.com/moluggg/image/raw/master/img/202008/01/093649-72979.png" /></p>
<p>lINGO åšè§„åˆ’</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href=".." title="ä¸»é¡µ" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  åé€€
                </span>
                ä¸»é¡µ
              </span>
            </div>
          </a>
        
        
          <a href="../a_cnn/" title="CNN" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  å‰è¿›
                </span>
                CNN
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.5e60981f.js"></script>
      
        
        
          
          <script src="../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
                <script src="../assets/javascripts/lunr/tinyseg.js"></script>
              
              
                <script src="../assets/javascripts/lunr/lunr.jp.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="../js/extra.js"></script>
      
        <script src="../js/baidu-tongji.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
    
      
    
  </body>
</html>